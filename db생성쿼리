--계정생성쿼리
CREATE USER css IDENTIFIED BY css;
GRANT CONNECT, RESOURCE, CREATE VIEW, CREATE SEQUENCE TO css;

DROP TABLE BOARD;
DROP TABLE BOARD_COMMENT;

CREATE TABLE BOARD(
B_KEY NUMBER PRIMARY KEY,
C_KEY_FK VARCHAR2(1000),
B_TITLE VARCHAR2(1000),
B_CONTENT VARCHAR2(4000),
B_WRITER varchar2(1000),
B_COUNT NUMBER,
B_DATE DATE,
B_CATEGORY VARCHAR2(1000)
);

CREATE TABLE BOARD_COMMENT(
CO_KEY NUMBER PRIMARY KEY,
B_KEY_FK NUMBER,
CO_WRITER VARCHAR2(1000),
CO_CONTENT VARCHAR2(4000),
CO_DATE DATE,
CONSTRAINT FK_B_KEY FOREIGN KEY (B_KEY_FK) REFERENCES BOARD(B_KEY)
);

COMMENT ON TABLE BOARD IS '게시판 테이블입니다';
COMMENT ON COLUMN BOARD.B_KEY IS '게시판 기본키';
COMMENT ON COLUMN BOARD.C_KEY_FK IS '회사키';
COMMENT ON COLUMN BOARD.B_TITLE IS '게시글 제목';
COMMENT ON COLUMN BOARD.B_CONTENT IS '글내용';
COMMENT ON COLUMN BOARD.B_WRITER IS '작성자';
COMMENT ON COLUMN BOARD.B_COUNT IS '조회수';
COMMENT ON COLUMN BOARD.B_DATE IS '작성일';
COMMENT ON COLUMN BOARD.B_CATEGORY IS '게시판 종류';

COMMENT ON TABLE BOARD_COMMENT IS '댓글 테이블입니다';
COMMENT ON COLUMN BOARD_COMMENT.CO_KEY IS '댓글 기본키';
COMMENT ON COLUMN BOARD_COMMENT.B_KEY_FK IS '외래키';
COMMENT ON COLUMN BOARD_COMMENT.CO_WRITER IS '작성자';
COMMENT ON COLUMN BOARD_COMMENT.CO_CONTENT IS '내용';
COMMENT ON COLUMN BOARD_COMMENT.CO_DATE IS '작성일';


--회사테이블
CREATE TABLE COMPANY(
 C_KEY NUMBER PRIMARY KEY,
 C_NAME VARCHAR2(300 BYTE),
 C_ID VARCHAR2(300 BYTE),
 C_OWNER VARCHAR2(300 BYTE),
 C_PWD VARCHAR2(300 BYTE),
 C_ADRESS VARCHAR2(300 BYTE),
 C_LOGO VARCHAR2(300 BYTE),
 C_SIGN VARCHAR2(300 BYTE),
 C_QRCODE VARCHAR2(300 BYTE),
 C_MILEAGE VARCHAR2(300 BYTE),
 C_CLOSEDAY DATE,
 C_LEVEL NUMBER
);

--결제테이블
CREATE TABLE PAYMENT(
PAY_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER,
PAY_MILEAGE VARCHAR2(300),
PAY_DATE DATE,
CONSTRAINT FK_C_KEY FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY(C_KEY)
);

--금액테이블
CREATE TABLE PRICE(
P_LEVEL NUMBER PRIMARY KEY,
P_EMPLOYEES NUMBER,
P_PRICE VARCHAR2(100)
);


--일정관리테이블
CREATE TABLE CALANDER(
CAL_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER,
CAL_WRITER NUMBER, --회사/부장/개인
CAL_OBJECT VARCHAR2, --대상자(E_KEY 또는 부서) 문자열
CAL_TITLE VARCHAR2,
CAL_STARTDATE DATE,
CAL_ENDDATE DATE,
CAL_TYPE VARCHAR2 NOT NULL
);

ALTER TABLE CALANDER ADD (FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY (C_KEY));

COMMENT ON TABLE CALANDER IS '일정테이블 입니다.';
COMMENT ON COLUMN CALANDER.C_NO IS '일정번호';
COMMENT ON COLUMN CALANDER.C_NAME IS '일정이름';
COMMENT ON COLUMN CALANDER.C_STARTDATE IS '일정시작시간';
COMMENT ON COLUMN CALANDER.C_ENDDATE IS '일정종료시간';
COMMENT ON COLUMN CALANDER.C_TYPE IS '일정종류';

--근태관리테이블
CREATE TABLE COMMUTE(
COMM_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER NOT NULL,
E_KEY_FK NUMBER NOT NULL,
COMM_YEARMONTH VARCHAR2(20),
COMM_DATE DATE NOT NULL,
COMM_INTIME DATE NOT NULL,
COMM_OUTTIME DATE NOT NULL
);

ALTER TABLE COMMUTE ADD (FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY (C_KEY));
ALTER TABLE COMMUTE ADD (FOREIGN KEY (E_KEY_FK) REFERENCES EMPLOYEE (E_KEY));

COMMENT ON TABLE COMMUTE IS '근태관리테이블 입니다.';
COMMENT ON COLUMN COMMUTE.CO_NO IS '근태넘버';
COMMENT ON COLUMN COMMUTE.C_NO IS '회사키(외래키)';
COMMENT ON COLUMN COMMUTE.M_NO IS '사원키(외래키)';
COMMENT ON COLUMN COMMUTE.C_DATE IS '출근날짜';
COMMENT ON COLUMN COMMUTE.C_INTIME IS '출근시간';
COMMENT ON COLUMN COMMUTE.C_OUTTIME IS '퇴근시간';

--휴가테이블
CREATE TABLE VACATION(
V_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER,
E_KEY_FK NUMBER NOT NULL,
V_USEDDATE NUMBER NOT NULL,
V_STARTDATE DATE,
V_RECALLDATE DATE
);

ALTER TABLE VACATION ADD (FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY (C_KEY));
ALTER TABLE VACATION ADD (FOREIGN KEY (E_KEY_FK) REFERENCES EMPLOYEE (E_KEY));

COMMENT ON TABLE VACATION IS '휴가테이블 입니다.';
COMMENT ON COLUMN VACATION.V_NO IS '휴가키';
COMMENT ON COLUMN VACATION.M_NO IS '사원키(외래키)';
COMMENT ON COLUMN VACATION.V_USEDDATE IS '사용일수';
COMMENT ON COLUMN VACATION.V_STARTDATE IS '시작일';
COMMENT ON COLUMN VACATION.V_RECALLDATE IS '종료일';

--휴가지급테이블
CREATE TABLE GIVEVACATION(
GV_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER,
GV_YEAR NUMBER NOT NULL, 
GV_VACADATE NUMBER NOT NULL,
GV_DATE DATE NOT NULL 
);

ALTER TABLE GIVEVACATION ADD (FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY (C_KEY));

COMMENT ON TABLE GIVEVACATION IS '휴가지급테이블 입니다.';
COMMENT ON COLUMN GIVEVACATION.C_NO IS '회사키';
COMMENT ON COLUMN GIVEVACATION.C_YEAR IS '근속년수';
COMMENT ON COLUMN GIVEVACATION.V_VACADATE IS '지급일수';
COMMENT ON COLUMN GIVEVACATION.V_DATE IS '휴가지급날짜';

--구분정보테이블
CREATE TABLE DIVISION(
 DIV_KEY NUMBER PRIMARY KEY,
 C_KEY_FK NUMBER,
 DIV_TYPE NUMBER,
 DIV_INFO VARCHAR2(300 BYTE)
);

--업무보고테이블
CREATE TABLE REPORT(
 REP_KEY NUMBER PRIMARY KEY,
 C_KEY_FK NUMBER,
 REP_TITLE VARCHAR2(300 BYTE),
 REP_CONTENT VARCHAR2(300 BYTE),
 REP_WRITER_FK VARCHAR2(300 BYTE),
 REP_DATE DATE
);


--사원테이블
CREATE TABLE EMPLOYEE(
    E_PK NUMBER PRIMARY KEY
    E_NO VARCHAR2(100),
    C_FK_NO NUMBER,
    E_ID VARCHAR2(300),
    E_PW VARCHAR2(300),
    E_NAME VARCHAR2(30),
    E_FK_JOBCODE  NUMBER,
    E_FK_DEPART NUMBER,
    E_ADDRESS VARCHAR2(300),
    E_EXTEN NUMBER,
    E_PHONE VARCHAR2(13),
    E_EMAIL VARCHAR2(100),
    E_HIRE_DATE DATE,
    E_ENT_DATE DATE,
    E_ENT_YN CHAR(1 BYTE) DEFAULT 'N',
    E_PHOTO VARCHAR2(100)
);

ALTER TABLE EMPLOYEE ADD(FOREIGN KEY (C_FK_NO) REFERENCES COMPANY (C_NO) ON DELETE CASCADE);
ALTER TABLE EMPLOYEE ADD(FOREIGN KEY (E_FK_JOBCODE) REFERENCES DIVISION (DIV_NO));
ALTER TABLE EMPLOYEE ADD(FOREIGN KEY (E_FK_DEPART) REFERENCES DIVISION (DIV_NO));


--전자결재테이블
CREATE TABLE APPROVAL(
A_KEY NUMBER PRIMARY KEY,
C_KEY_FK NUMBER,
A_TITLE VARCHAR2(300),
A_WRITER_FK NUMBER,
A_WRITE_DATE DATE,
A_DOCUMENT_TYPE VARCHAR2(100),
A_CONDITION NUMBER CHECK (A_CONDITION BETWEEN 0 AND 2)
);

ALTER TABLE APPROVAL ADD (FOREIGN KEY (A_WRITER_FK) REFERENCES EMPLOYEE (E_KEY));
ALTER TABLE APPROVAL ADD (FOREIGN KEY (C_KEY_FK) REFERENCES COMPANY (C_KEY));


--전자결재상태테이블
CREATE TABLE APPROVAL_CONDITION(
AC_KEY NUMBER PRIMARY KEY,
A_KEY_FK NUMBER,
AC_APPROVER_FK NUMBER,
AC_CONDITION NUMBER CHECK (CONDITION BETWEEN 0 AND 2),
AC_APPROVAL_DATE DATE
);

ALTER TABLE APPROVAL_CONDITION ADD (FOREIGN KEY (A_KEY_FK) REFERENCES APPROVAL (A_KEY));
ALTER TABLE APPROVAL_CONDITION ADD (FOREIGN KEY (AC_APPROVER_FK) REFERENCES EMPLOYEE (E_KEY));


--첨부파일테이블
CREATE TABLE ATTACHMENT (
ATTACHMENT_KEY NUMBER PRIMARY KEY,
LOCATION_FK NUMBER,
FILENAME VARCHAR2(300),
FILEPATH VARCHAR2(1000)
);

--보낸쪽지
CREATE TABLE SENDNOTE(
    SN_KEY NUMBER PRIMARY KEY,
    SN_SENDER_FK VARCHAR2(300),
    SN_TITLE VARCHAR2(4000),
    SN_CONTENT VARCHAR2(4000),
    SN_WRITE_DATE DATE,
    SN_DELETE_YN CHAR(1) DEFAULT 'N'
);

ALTER TABLE SENDNOTE ADD(FOREIGN KEY(SN_SENDER_FK) REFERENCES EMPLOYEE (E_KEY));

--쪽지받는사람
CREATE TABLE RECEIVENOTE(
    RN_KEY NUMBER PRIMARY KEY,
    RN_RECEVER_FK NUMBER,
    RN_RECIPIENT VARCHAR2(100),
    RN_READ_YN CHAR(1) DEFAULT 'N',
    RN_DELETE_YN CHAR(1) DEFAULT 'N'
);

ALTER TABLE RECEIVENOTE ADD(FOREIGN KEY(RN_RECEVER_FK) REFERENCES SENDNOTE (SN_KEY));

